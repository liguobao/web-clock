<!DOCTYPE html>
<html lang="zh-CN" style="background-color: #000000;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="R2049 åœ¨çº¿æ—¶é’Ÿ">
    <meta name="keywords" content="R2049, åœ¨çº¿æ—¶é’Ÿ, æ—¶é’Ÿ, æ—¶é—´, æ—¥æœŸ, å†œå†">
    <meta name="theme-color" content="#000000">
    <title>R2049 åœ¨çº¿æ—¶é’Ÿ</title>
    <style>
        /* ç¡®ä¿iPad 2ä¸Šçš„åŸºæœ¬æ ·å¼ */
        html, body {
            background-color: #000000;
            color: #ffffff;
        }
        
        body.day-mode {
            background-color: #f0f0f0;
            color: #333333;
        }
    </style>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="æ•°å­—æ—¶é’Ÿ">
    <!-- å†…è”è„šæœ¬ï¼Œç¡®ä¿åŸºæœ¬å†…å®¹èƒ½ç«‹å³æ˜¾ç¤ºï¼ˆä¸ºiPad 2ç­‰æ—§è®¾å¤‡ä¼˜åŒ–ï¼‰ -->
    <script>
        // é¦–å…ˆç¡®ä¿èƒŒæ™¯é¢œè‰²è®¾ç½®æ­£ç¡®
        document.documentElement.style.backgroundColor = "#000000";
        document.body.style.backgroundColor = "#000000";
        
        function updateBasicTime() {
            try {
                var now = new Date();
                
                // æ›´æ–°æ—¥æœŸä¿¡æ¯
                var dateInfoEl = document.getElementById('date-info');
                if (dateInfoEl) {
                    var weekdays = ["æ˜ŸæœŸæ—¥", "æ˜ŸæœŸä¸€", "æ˜ŸæœŸäºŒ", "æ˜ŸæœŸä¸‰", "æ˜ŸæœŸå››", "æ˜ŸæœŸäº”", "æ˜ŸæœŸå…­"];
                    dateInfoEl.textContent = now.getFullYear() + "å¹´" + (now.getMonth() + 1) + "æœˆ" + now.getDate() + "æ—¥ " + weekdays[now.getDay()];
                }
                
                // è®¾ç½®å†œå†å ä½ç¬¦
                var lunarDateEl = document.getElementById('lunar-date');
                if (lunarDateEl) {
                    lunarDateEl.textContent = "å†œå†æ•°æ®åŠ è½½ä¸­...";
                }
                
                // æ›´æ–°æ—¶é—´
                var h = now.getHours();
                var m = now.getMinutes();
                var s = now.getSeconds();
                
                // æ·»åŠ å‰å¯¼é›¶
                h = h < 10 ? "0" + h : h.toString();
                m = m < 10 ? "0" + m : m.toString();
                s = s < 10 ? "0" + s : s.toString();
                
                // ç®€å•æ›´æ–°æ—¶é—´æ˜¾ç¤º
                updateSimpleElement('hour-unit', h);
                updateSimpleElement('minute-unit', m);
                updateSimpleElement('second-unit', s);
                
                // è®¾ç½®ç™½å¤©/å¤œæ™šæ¨¡å¼
                var isDayTime = h >= 6 && h < 18;
                if (isDayTime) {
                    document.body.className = 'day-mode';
                    document.body.style.backgroundColor = "#f0f0f0";
                } else {
                    document.body.className = 'night-mode';
                    document.body.style.backgroundColor = "#000000";
                }
            } catch (err) {
                console.error("å†…è”è„šæœ¬æ›´æ–°æ—¶é—´å‡ºé”™", err);
            }
        }
        
        function updateSimpleElement(id, value) {
            try {
                var el = document.getElementById(id);
                if (!el) return;
                
                var digits = el.getElementsByClassName('digit');
                if (digits.length >= 2) {
                    digits[0].textContent = value[0];
                    digits[1].textContent = value[1];
                }
            } catch (err) {
                console.error("æ›´æ–°å…ƒç´ å‡ºé”™", err);
            }
        }
        
        // å½“é¡µé¢é¦–æ¬¡åŠ è½½æ—¶æ‰§è¡Œ
        document.addEventListener("DOMContentLoaded", updateBasicTime);
        
        // ç«‹å³å°è¯•æ‰§è¡Œä¸€æ¬¡
        if (document.readyState === "interactive" || document.readyState === "complete") {
            updateBasicTime();
        }
    </script>
</head>
<body style="background-color: #000000; color: #ffffff;">
    <div class="clock-container">
        <div class="header-container">
            <h1 class="clock-title">R2049 åœ¨çº¿æ—¶é’Ÿ</h1>

            <!-- æ·»åŠ åŸå¸‚é€‰æ‹©åŠŸèƒ½ -->
            <div class="city-selector">
                <select id="city-select">
                    <option value="ä¸Šæµ·" selected>ä¸Šæµ·</option>
                    <option value="åŒ—äº¬">åŒ—äº¬</option>
                    <option value="å¹¿å·">å¹¿å·</option>
                    <option value="æ·±åœ³">æ·±åœ³</option>
                    <option value="æ­å·">æ­å·</option>
                    <option value="æˆéƒ½">æˆéƒ½</option>
                    <option value="é‡åº†">é‡åº†</option>
                    <option value="æ­¦æ±‰">æ­¦æ±‰</option>
                    <option value="è¥¿å®‰">è¥¿å®‰</option>
                    <option value="å—äº¬">å—äº¬</option>
                    <option value="é•¿æ²™">é•¿æ²™</option>
                    <option value="å¦é—¨">å¦é—¨</option>
                    <option value="é’å²›">é’å²›</option>
                    <option value="å¤©æ´¥">å¤©æ´¥</option>
                    <option value="éƒ‘å·">éƒ‘å·</option>
                    <option value="ä¸œè">ä¸œè</option>
                    <option value="ä½›å±±">ä½›å±±</option>
                </select>
            </div>
        </div>

        <!-- ä¿®æ”¹å¤©æ°”ä¿¡æ¯é“¾æ¥ -->
        <a href="https://wttr.r2049.cn/" target="_blank"><div class="weather-info" id="weather-info">å¤©æ°”ä¿¡æ¯åŠ è½½ä¸­...</div></a>
        
        <div class="date-info" id="date-info">åŠ è½½ä¸­...</div>
        <div class="lunar-date" id="lunar-date">å†œå†åŠ è½½ä¸­...</div>
        

        
        <div class="time-container">
            <div class="time-unit" id="hour-unit">
                <div class="time-label">æ—¶</div>
                <div class="digits-container">
                    <div class="digit">0</div>
                    <div class="digit">0</div>
                </div>
            </div>
            
            <div class="time-separator">:</div>
            
            <div class="time-unit" id="minute-unit">
                <div class="time-label">åˆ†</div>
                <div class="digits-container">
                    <div class="digit">0</div>
                    <div class="digit">0</div>
                </div>
            </div>
            
            <div class="time-separator">:</div>
            
            <div class="time-unit" id="second-unit">
                <div class="time-label">ç§’</div>
                <div class="digits-container">
                    <div class="digit">0</div>
                    <div class="digit">0</div>
                </div>
            </div>
        </div>
        
        <!-- <div class="custom-message">åœ¨è¿™é‡Œæ˜¾ç¤ºæ‚¨çš„è‡ªå®šä¹‰ä¿¡æ¯</div> -->
        <a href="https://www.jinrishici.com/" target="_blank" style="color: white; text-decoration: none;">
            <span id="jinrishici-sentence">æ­£åœ¨åŠ è½½ä»Šæ—¥è¯—è¯....</span>
        </a>
        <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
        <div class="pwa-install-hint" style="margin-top: 10px;text-align: center;">
          <a href="#" id="install-button">ğŸ“± æ·»åŠ åˆ°ä¸»å±å¹•</a>
        </div>
        <div class="footer">Power By <a href="https://github.com/liguobao/web-clock" target="_blank">@liguobao/web-clock</a></div>
    </div>
    
    <!-- åœ¨ä¸»å†…å®¹ååŠ è½½å¤–éƒ¨è„šæœ¬ -->
    <script src="script.js"></script>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FGRZTB4F5N"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-FGRZTB4F5N');
    </script>

    <script>
        // æ³¨å†Œ Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('./sw.js')
                    .then(function(reg) { console.log('Service Worker å·²æ³¨å†Œ'); })
                    .catch(function(err) { console.log('Service Worker æ³¨å†Œå¤±è´¥:', err); });
            });
        }
    </script>

    <!-- æ·»åŠ åŸå¸‚é€‰æ‹©å’Œå¤©æ°”è·å–çš„è„šæœ¬ -->
    <script>
        // è·å–å¤©æ°”ä¿¡æ¯
        function getWeatherInfo(city) {
            try {
                var weatherInfoEl = document.getElementById('weather-info');
                if (!weatherInfoEl) return;
                
                // æ˜¾ç¤ºåŠ è½½ä¸­çŠ¶æ€
                weatherInfoEl.textContent = "æ­£åœ¨è·å–å¤©æ°”ä¿¡æ¯...";
                
                // æ„å»ºè¯·æ±‚URLï¼Œé»˜è®¤ä¸ºä¸Šæµ·
                var city = city || 'ä¸Šæµ·';
                var encodedCity = encodeURIComponent(city);
                var url = 'https://wttr.r2049.cn/?location=' + encodedCity;
                
                // ä½¿ç”¨XMLHttpRequestè·å–å¤©æ°”
                var xhr = new XMLHttpRequest();
                xhr.open('GET', url, true);
                
                xhr.onreadystatechange = function() {
                    if (xhr.readyState === 4) {
                        if (xhr.status === 200) {
                            // ç›´æ¥ä½¿ç”¨è¿”å›çš„æ–‡æœ¬
                            weatherInfoEl.textContent = xhr.responseText;
                        } else {
                            console.error("è·å–å¤©æ°”ä¿¡æ¯å¤±è´¥ï¼ŒçŠ¶æ€ç :", xhr.status);
                            weatherInfoEl.textContent = "å¤©æ°”ä¿¡æ¯è·å–å¤±è´¥";
                        }
                    }
                };
                
                xhr.onerror = function() {
                    console.error("è·å–å¤©æ°”ä¿¡æ¯è¯·æ±‚é”™è¯¯");
                    weatherInfoEl.textContent = "å¤©æ°”ä¿¡æ¯è·å–å¤±è´¥";
                };
                
                xhr.timeout = 10000; // 10ç§’è¶…æ—¶
                xhr.ontimeout = function() {
                    console.error("è·å–å¤©æ°”ä¿¡æ¯è¯·æ±‚è¶…æ—¶");
                    weatherInfoEl.textContent = "å¤©æ°”ä¿¡æ¯è·å–è¶…æ—¶";
                };
                
                xhr.send();
            } catch (err) {
                console.error("è·å–å¤©æ°”ä¿¡æ¯å‡ºé”™:", err);
                if (weatherInfoEl) {
                    weatherInfoEl.textContent = "å¤©æ°”ä¿¡æ¯æš‚ä¸å¯ç”¨";
                }
            }
        }

        // åˆå§‹åŒ–åŸå¸‚é€‰æ‹©å™¨
        function initCitySelector() {
            var citySelect = document.getElementById('city-select');
            if (citySelect) {
                // ä»æœ¬åœ°å­˜å‚¨åŠ è½½ä¸Šæ¬¡é€‰æ‹©çš„åŸå¸‚
                var savedCity = localStorage.getItem('selectedCity');
                if (savedCity) {
                    citySelect.value = savedCity;
                }
                
                // æ·»åŠ å˜æ›´äº‹ä»¶
                citySelect.addEventListener('change', function() {
                    var selectedCity = this.value;
                    // ä¿å­˜é€‰æ‹©åˆ°æœ¬åœ°å­˜å‚¨
                    localStorage.setItem('selectedCity', selectedCity);
                    // è·å–æ–°åŸå¸‚çš„å¤©æ°”
                    getWeatherInfo(selectedCity);
                });
                
                // åˆå§‹åŠ è½½å¤©æ°”
                getWeatherInfo(citySelect.value);
            } else {
                // å¦‚æœé€‰æ‹©å™¨ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤åŸå¸‚
                getWeatherInfo('ä¸Šæµ·');
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initCitySelector();
        });
        
        // æ¯å°æ—¶æ›´æ–°ä¸€æ¬¡å¤©æ°”
        setInterval(function() {
            var citySelect = document.getElementById('city-select');
            var city = citySelect ? citySelect.value : 'ä¸Šæµ·';
            getWeatherInfo(city);
        }, 3600000);
    </script>
</body>
</html>
